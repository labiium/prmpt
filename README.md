# Curly

Curly is a command-line tool that helps you convert code repositories into prompts for Large Language Models (LLMs) and inject code generated by LLMs back into your repositories. It streamlines the process of working with LLMs for code generation, code reviews, and documentation.

## Features

- **Generate Prompts**: Convert your codebase into a structured prompt suitable for LLMs.
- **Inject Code**: Automatically insert code from LLM outputs back into your repository.
- **Custom Configurations**: Define multiple configurations in `curly.yaml` for different use cases.
- **Language Awareness**: Ignores irrelevant files based on the specified programming language.
- **Prompt Annotations**: Add custom prompts to specific files directly from your configuration.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
  - [Help Command](#help-command)
  - [Generate](#generate)
  - [Inject](#inject)
  - [Custom Configurations](#custom-configurations)
- [Examples](#examples)
- [Prompt Format for LLMs](#prompt-format-for-llms)
- [Configuration Options](#configuration-options)
- [Contributing](#contributing)
- [License](#license)
- [Contact](#contact)

## Installation

First, ensure you have [Rust](https://www.rust-lang.org/tools/install) and Cargo installed.

Clone the repository and build the project:

```bash
git clone https://github.com/yourusername/curly.git
cd curly
cargo build --release
```

This will create an executable at `target/release/curly`. You can add this to your `PATH` or move it to a directory that's already in your `PATH`.

## Usage

Curly provides two main commands:

- `generate`: Converts your repository into a prompt.
- `inject`: Injects code from an input file into your repository.

Additionally, you can define and run custom configurations from `curly.yaml`.

### Help Command

For full usage information:

```bash
curly --help
```

### Generate

The `generate` command creates a prompt from your code repository.

**Basic Usage:**

```bash
curly generate --path my_project --language rust --output output.txt
```

**Options:**

- `--path`: Path to the code repository (default: current directory).
- `--language`: Programming language of the repository.
- `--output`: Output file for the generated prompt.
- `--ignore`: Patterns to ignore (can be specified multiple times).
- `--delimiter`: Delimiter for code blocks (default: ```).

**Example:**

```bash
curly generate --path src --language python --ignore "*.test.py" --output prompt.txt
```

### Inject

The `inject` command inserts code from an input file into your repository.

**Basic Usage:**

```bash
curly inject --input output.txt --path my_project
```

**Options:**

- `--input`: Input file containing code to inject (default: `output.txt`).
- `--path`: Path to the repository where code will be injected (default: current directory).

### Custom Configurations

Curly supports custom configurations defined in a `curly.yaml` file. This allows you to predefine settings for different scenarios.

**Example `curly.yaml`:**

```yaml
base:
  path: my_project
  language: rust
  output: output.txt
  ignore:
    - target
    - "*.log"
  prompts:
    src/main.rs: "Add detailed documentation comments."
    src/lib.rs: "Refactor for performance."
  use_gitignore: true

docs_only:
  path: docs
  language: python
  docs_comments_only: true
```

**Running a Configuration:**

```bash
curly base
```

**Note:** Reserved keywords like `inject`, `generate`, `help`, `--help`, and `-h` cannot be used as configuration names.

## Examples

**Generate with Default Configuration:**

```bash
curly
```

This runs the `base` configuration from `curly.yaml`.

**Generate Using Specific Configuration:**

```bash
curly docs_only
```

This runs the `docs_only` configuration.

**Inject Code into a Repository:**

```bash
curly inject --input output.txt --path my_project
```

## Prompt Format for LLMs

To ensure that the LLM outputs code in a format compatible with Curly's `inject` command, include the following guidelines in your prompt:

- Provide the relative file path at the top of each code block.
- Follow the relative file path with the code, without additional text in between.
- Use appropriate code block delimiters and language identifiers.
- Include comments that logically explain the code.

**Example Prompt:**

```markdown
`src/main.rs`

```rust
fn main() {
    println!("Hello, world!");
}
```

`src/utils/helpers.py`

```python
def helper_function():
    """This function helps with X."""
    pass
```
```

## Configuration Options

- `path` *(string)*: Path to the code repository.
- `ignore` *(list of strings)*: Glob patterns of files or directories to ignore.
- `output` *(string)*: Output file for the generated prompt.
- `delimiter` *(string)*: Delimiter for code blocks (default: ```).
- `language` *(string)*: Programming language of the repository.
- `prompts` *(mapping)*: Custom prompts for specific files.
- `docs_comments_only` *(bool)*: If `true`, only extracts documentation and comments.
- `use_gitignore` *(bool)*: If `true`, respects patterns in `.gitignore`.

## Contributing

We welcome contributions! Please follow these steps:

1. **Fork the Repository:** Click the "Fork" button on GitHub.
2. **Create a Branch:** Use `git checkout -b feature-name`.
3. **Commit Your Changes:** Make sure to write clear commit messages.
4. **Push to Your Fork:** Use `git push origin feature-name`.
5. **Submit a Pull Request:** Describe your changes in detail.

For major changes, please open an issue first to discuss what you would like to change.

## License

Curly is licensed under the [MIT License](LICENSE).

## Contact

For questions or support, please open an issue on the [GitHub repository](https://github.com/yourusername/curly) or contact [your.email@example.com](mailto:your.email@example.com).